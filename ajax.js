!function(p){"use strict";phpbb.addAjaxCallback("mark_forums_read",function(t){var a=t.NO_UNREAD_POSTS,o=t.UNREAD_POSTS,i={forum_unread:"forum_read",forum_unread_subforum:"forum_read_subforum",forum_unread_locked:"forum_read_locked"};p("li.row").find('dl[class*="forum_unread"]').each(function(){var e=p(this);p.each(i,function(t,a){e.hasClass(t)&&e.removeClass(t).addClass(a)}),e.children('dt[title="'+o+'"]').attr("title",a)}),p('a.subforum[class*="unread"]').removeClass("unread").addClass("read").children(".icon.icon-red").removeClass("icon-red").addClass("icon-blue"),p("#active_topics").length&&phpbb.ajaxCallbacks.mark_topics_read.call(this,t,!1),p('[data-ajax="mark_forums_read"]').attr("href",t.U_MARK_FORUMS),phpbb.closeDarkenWrapper(3e3)}),phpbb.addAjaxCallback("mark_topics_read",function(t,a){var e,o=t.NO_UNREAD_POSTS,i=t.UNREAD_POSTS,n=["","_hot","_hot_mine","_locked","_locked_mine","_mine"],l={},s=[];void 0===a&&(a=!0),p.each({global_unread:"global_read",announce_unread:"announce_read",sticky_unread:"sticky_read",topic_unread:"topic_read"},function(e,o){p.each(n,function(t,a){return("_hot"===a||"_hot_mine"===a)&&"topic_unread"!==e||(l[e+a]=o+a,void s.push(e+a))})}),e="."+s.join(",."),p("li.row").find(e).each(function(){var e=p(this);p.each(l,function(t,a){e.hasClass(t)&&e.removeClass(t).addClass(a)}),e.children('dt[title="'+i+'"]').attr("title",o)}),p("a.unread").has(".icon-red").remove(),a&&p('[data-ajax="mark_topics_read"]').attr("href",t.U_MARK_TOPICS),phpbb.closeDarkenWrapper(3e3)}),phpbb.addAjaxCallback("notification.mark_all_read",function(t){void 0!==t.success&&(phpbb.markNotifications(p("#notification_list li.bg2"),0),phpbb.closeDarkenWrapper(3e3))}),phpbb.addAjaxCallback("notification.mark_read",function(t){void 0!==t.success&&(t=Number(p("#notification_list_button strong").html())-1,phpbb.markNotifications(p(this).parent("li.bg2"),t))}),phpbb.markNotifications=function(t,a){t.removeClass("bg2"),t.find("a.mark_read").remove(),t.each(function(){var t=p(this).find("a");t.attr("href",t.attr("data-real-url"))}),p("strong","#notification_list_button").html(a),a||(p("#mark_all_notifications").remove(),p("#notification_list_button > strong").addClass("hidden"));var e=p("title"),t=e.text().replace(/(\((\d+)\))/,"");e.text((a?"("+a+")":"")+t)},phpbb.addAjaxCallback("post_delete",function(){var t,a=p(this);void 0===a.attr("data-refresh")&&(t=a[0].href.split("&p=")[1],((a=a.parents("#p"+t).css("pointer-events","none")).hasClass("bg1")||a.hasClass("bg2"))&&(t=a.nextAll(".bg1"),a.nextAll(".bg2").removeClass("bg2").addClass("bg1"),t.removeClass("bg1").addClass("bg2")),a.fadeOut(function(){p(this).remove()}))}),phpbb.addAjaxCallback("post_visibility",function(t){var a=t.visible?p(this):p(this).parents(".post");p(a).css("pointer-events","none").fadeOut(function(){p(this).remove()}),t.visible&&a.parents(".post").find(".post_deleted_msg").css("pointer-events","none").fadeOut(function(){p(this).remove()})}),phpbb.addAjaxCallback("row_delete",function(){p(this).parents("tr").remove()}),phpbb.addAjaxCallback("zebra",function(t){var a;t.success&&((a=p(".zebra")).first().html(t.MESSAGE_TEXT),a.not(":first").html("&nbsp;").prev().html("&nbsp;"))}),phpbb.addAjaxCallback("vote_poll",function(d){var t,o,a,c,e,i,n;void 0!==d.success&&(t=p(this).closest(".topic_poll"),o=t.find(".panel"),a=t.find("dl:first-child .resultbar").is(":visible"),c=0,(e=function(t){t=void 0===t?o.find(".inner").outerHeight():t,o.css("min-height",t)})(),a||t.find(".poll_view_results").hide(500),d.can_vote?t.find(".resultbar, .poll_option_percent, .poll_total_votes").show(500):t.find(".polls, .poll_max_votes, .poll_vote, .poll_option_select").fadeOut(500,function(){t.find(".resultbar, .poll_option_percent, .poll_total_votes").show()}),t.find("[data-poll-option-id]").each(function(){var t=p(this).attr("data-poll-option-id");c=d.vote_counts[t]>=c?d.vote_counts[t]:c}),t.find(".poll_total_vote_cnt").html(d.total_votes),t.find("[data-poll-option-id]").each(function(){var a=p(this),e=a.attr("data-poll-option-id"),t=void 0!==d.user_votes[e],o=d.vote_counts[e]===c,i=d.total_votes?Math.round(d.vote_counts[e]/d.total_votes*100):0,n=0===c?0:Math.round(d.vote_counts[e]/c*100),l=a.attr("data-alt-text");t?a.attr("title",p.trim(l)):a.attr("title",""),a.toggleClass("voted",t),a.toggleClass("most-votes",o);var s=a.find(".resultbar div"),o=d.can_vote?500:1500,r=100===i?"pollbar5":"pollbar"+(Math.floor(i/20)+1);setTimeout(function(){s.animate({width:n+"%"},500).removeClass("pollbar1 pollbar2 pollbar3 pollbar4 pollbar5").addClass(r).html(d.vote_counts[e]);var t=i?i+"%":d.NO_VOTES;a.find(".poll_option_percent").html(t)},o)}),d.can_vote||t.find(".polls").delay(400).fadeIn(500),i=d.can_vote?300:900,t.find(".vote-submitted").delay(i).slideDown(200,function(){a&&e(),p(this).delay(5e3).fadeOut(500,function(){n(300)})}),setTimeout(function(){n(500)},1500),n=function(t){var a=o.height(),e=o.find(".inner").outerHeight();a!==e&&o.css({minHeight:"",height:a}).animate({height:e},t,function(){o.css({minHeight:e,height:""})})})}),p(".poll_view_results a").click(function(t){t.preventDefault();t=p(this).parents(".topic_poll");t.find(".resultbar, .poll_option_percent, .poll_total_votes").show(500),t.find(".poll_view_results").hide(500)}),p("[data-ajax]").each(function(){var t=p(this),a=t.attr("data-ajax"),e=t.attr("data-filter");"false"!==a&&(a="true"!==a?a:null,e=void 0!==e?phpbb.getFunctionByName(e):null,phpbb.ajaxify({selector:this,refresh:void 0!==t.attr("data-refresh"),filter:e,callback:a}))}),p("#qr_full_editor").click(function(){p("#qr_postform").attr("action",function(t,a){return a+"#preview"})}),p(".display_post").click(function(t){t.preventDefault();t=p(this).attr("data-post-id");p("#post_content"+t).show(),p("#profile"+t).show(),p("#post_hidden"+t).hide()}),p("#member_search").click(function(){var t=p("#memberlist_search");return t.slideToggle("fast"),phpbb.ajaxCallbacks.alt_text.call(this),t.is(":visible")&&p("#username").focus(),!1}),p(function(){var t=p("textarea:not(#message-box textarea, .no-auto-resize)");phpbb.resizeTextArea(t,{minHeight:75,maxHeight:250}),phpbb.resizeTextArea(p("textarea","#message-box"))})}(jQuery);